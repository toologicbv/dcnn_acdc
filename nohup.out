INFO - root_dir : /home/jorg/repository/dcnn_acdc
INFO - val_freq : 1000
INFO - exper_dict : {0: '20180418_15_02_05_dcnn_mcv1_150000E_lr2e02', 1: '20180426_14_13_46_dcnn_mc_f1p01_brier_150KE_lr2e02', 2: '20180426_14_14_39_dcnn_mc_f2p01_brier_150KE_lr2e02', 3: '20180426_14_14_57_dcnn_mc_f3p01_brier_150KE_lr2e02'}
INFO - type_of_map : e_map
INFO - retrain_exper : None
INFO - quick_run : False
INFO - version : v1
INFO - lr : 0.0001
INFO - log_dir : 20181023_19_11_29_rd1_f0_brier_emap_20KE_lr1e04
INFO - fold_id : 0
INFO - cuda : True
INFO - retrain_chkpnt : None
INFO - use_no_map : False
INFO - num_input_chnls : 3
INFO - batch_size : 128
INFO - chkpnt : True
INFO - use_random_map : False
INFO - epochs : 20000
INFO - chkpnt_freq : 10000
INFO - print_freq : 100
INFO - use_cuda : True
INFO - model : rd1
INFO -  *** RUNNING ON GPU *** 
INFO - INFO - Creating dataset for slice detection. This may take a while, be patient!
  0%|          | 0/25 [00:00<?, ?it/s]Load experiment from /home/jorg/repository/dcnn_acdc/logs/20180418_15_02_05_dcnn_mcv1_150000E_lr2e02/stats/exper_stats.dll
INFO - Experimental details extracted:: dcnn_mc p=0.10 fold=['0'] loss=brier
Load experiment from /home/jorg/repository/dcnn_acdc/logs/20180426_14_13_46_dcnn_mc_f1p01_brier_150KE_lr2e02/stats/exper_stats.dll
INFO - Experimental details extracted:: dcnn_mc p=0.10 fold=['1'] loss=brier
Load experiment from /home/jorg/repository/dcnn_acdc/logs/20180426_14_14_39_dcnn_mc_f2p01_brier_150KE_lr2e02/stats/exper_stats.dll
INFO - Experimental details extracted:: dcnn_mc p=0.10 fold=['2'] loss=brier
Load experiment from /home/jorg/repository/dcnn_acdc/logs/20180426_14_14_57_dcnn_mc_f3p01_brier_150KE_lr2e02/stats/exper_stats.dll
INFO - Experimental details extracted:: dcnn_mc p=0.10 fold=['3'] loss=brier
INFO - Preparing experimental handlers. This may take a while. Be patient...
INFO - Ready. Loop through patient ids.
  8%|8         | 2/25 [00:00<00:01, 12.76it/s] 16%|#6        | 4/25 [00:00<00:01, 12.47it/s] 24%|##4       | 6/25 [00:00<00:01, 12.10it/s] 32%|###2      | 8/25 [00:00<00:01, 13.08it/s] 40%|####      | 10/25 [00:00<00:01, 13.25it/s] 48%|####8     | 12/25 [00:00<00:00, 13.11it/s] 56%|#####6    | 14/25 [00:01<00:00, 12.80it/s] 64%|######4   | 16/25 [00:01<00:00, 13.00it/s] 72%|#######2  | 18/25 [00:01<00:00, 13.40it/s] 80%|########  | 20/25 [00:01<00:00, 12.80it/s] 88%|########8 | 22/25 [00:01<00:00, 12.20it/s] 96%|#########6| 24/25 [00:01<00:00, 12.35it/s]100%|##########| 25/25 [00:02<00:00, 12.33it/s]
  0%|          | 0/25 [00:00<?, ?it/s]  4%|4         | 1/25 [00:00<00:03,  7.45it/s]  8%|8         | 2/25 [00:00<00:02,  7.91it/s] 16%|#6        | 4/25 [00:00<00:02, 10.26it/s] 24%|##4       | 6/25 [00:00<00:01, 10.93it/s] 32%|###2      | 8/25 [00:00<00:01, 11.18it/s] 40%|####      | 10/25 [00:00<00:01, 11.65it/s] 48%|####8     | 12/25 [00:01<00:01, 11.62it/s] 56%|#####6    | 14/25 [00:01<00:00, 12.18it/s] 64%|######4   | 16/25 [00:01<00:00, 11.53it/s] 72%|#######2  | 18/25 [00:01<00:00, 11.46it/s] 80%|########  | 20/25 [00:01<00:00, 11.04it/s] 88%|########8 | 22/25 [00:01<00:00, 11.37it/s] 96%|#########6| 24/25 [00:02<00:00, 11.32it/s]
Traceback (most recent call last):
  File "train_region_detector.py", line 127, in <module>
    main()
  File "train_region_detector.py", line 123, in main
    training(args)
  File "train_region_detector.py", line 34, in training
    model_name=exper_hdl.exper.run_args.model)
  File "/mnt/u_drive/repository/dcnn_acdc/in_out/detector/detector_dataset.py", line 316, in create_dataset
    patient_ids=ensemble_patients)
  File "/mnt/u_drive/repository/dcnn_acdc/utils/exper_hdl_ensemble.py", line 106, in prepare_handlers
    self.get_images(f_id)
  File "/mnt/u_drive/repository/dcnn_acdc/utils/exper_hdl_ensemble.py", line 37, in get_images
    self.seg_exper_handlers[fold_id].get_test_set()
  File "/mnt/u_drive/repository/dcnn_acdc/utils/experiment.py", line 1212, in get_test_set
    batch_size=None, use_cuda=use_cuda)
  File "/mnt/u_drive/repository/dcnn_acdc/utils/test_handler.py", line 1118, in get_testset_instance
    load_train=load_train, load_val=load_val, use_iso_path=True)
  File "/mnt/u_drive/repository/dcnn_acdc/utils/test_handler.py", line 218, in __init__
    self._load_file_list(file_list)
  File "/mnt/u_drive/repository/dcnn_acdc/utils/test_handler.py", line 353, in _load_file_list
    labels, num_labels_per_class = self._split_class_labels(reference_ed, reference_es)
  File "/mnt/u_drive/repository/dcnn_acdc/utils/test_handler.py", line 391, in _split_class_labels
    labels_per_class[cls_idx + self.num_of_classes, :, :, :] = (labels_ed == cls_idx).astype('int16')
KeyboardInterrupt
